---
layout:     post
title:      Fps 武器连发和基础武器摇动
subtitle:   基础内容
date:       2020-4-16
author:     AIaimuti
header-img: img/post-bg-open-source-blog.jpg
catalog: true
tags:
    - UE4 蓝图实现FPS系列
---

## 基础武器晃动

采用F插值到Finterp To函数
第一个Current参数为当前值
第二个target参数：目标值
第三个参数delta Time:两帧之间的时间
第四个参数Interp Speed:插值速度
功能就是将Current值按一定速度不断增加到target值，起到平滑的作用。
类似的还有Vinterp To、Rinterp To和Tinterp To

**功能需求**：FPS在游戏中实现简单的晃动效果就是获取鼠标X、Y轴的偏移量，在此基础上进行一个偏移量的插值作用于骨骼，形成晃动的效果

首先，**在Player蓝图**中将鼠标X、Y轴的输入量获取为变量Shake_X_Axis和Shake_Y_Axis。
然后在**动画蓝图**中蓝图动画初始化的时候 CastToPlayer，获取Player相关参数，即Shake_X_Axis和Shake_Y_Axis，这个值一种在变，所以作为target参数。
然后新建Y Bias和 Z Bias作为初始变量，采用Finterp To函数，将输出的值分别赋给Y Bias和 Z Bias
Y Bias为竖直方向骨骼晃动，Transform(modify)Bone X引脚竖直控制骨骼晃动，Y Bias连接X引脚；
Z Bias为水平方向骨骼晃动，Transform(modify)Bone Z引脚水平控制骨骼晃动，Z Bias连接Z引脚；


GetAllActorsOfClass性能开销会比较大
一般物体创建的时候进行CastTo操作进行变量的生成会性能好一些

## 射线检测

Object Channel：只追踪指定类型的物体
Trace Channel：射线检测，对指定遮挡的物体进行最终，一般默认全部忽略，然后对希望被检测的物体设置阻挡
ignore 忽略，湖绿不会被检测到
Overlap 可以检测到，但会穿过物体，物体后面的物体也会被检测到
Block 阻挡，阻挡会被检测到

## 摄像头震荡
右键内容浏览器-->Blueprints蓝图类-->搜索CameraShake
Oscillation Duration：震荡持续时间
Oscillation Blend in Time：震荡混入时间
Oscillation Blend Out Time：震荡混出时间

Rot Oscillation：旋转震荡
Loc Oscillation：位置震荡
FOV Oscillation：镜头远近震荡

GetPlayerCameraManager-->PlayCameraShake
PlayCameraShake:
Shake Class:选择创建的摄像机晃动蓝图类

## 准星
右键内容浏览器-->UserInterface用户接口-->Widget Blueprint部件蓝图
Broder拖入中间，将Anchors锚点设置为中间Position X和Position Y设置为0，Size X设置为2，Size Y设置为15
然后将Alignment对准调整为X 0.5和Y 0.5，并Ctrl + W复制5个，
将其中一个Size X和Size Y设置为2，其中两个调整上下位置
另外两个在details面板Render Transform中Angel设置为90，
稍作调整，去掉中心。

